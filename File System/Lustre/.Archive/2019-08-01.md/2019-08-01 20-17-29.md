date: 2019-08-01 20:15
app: markdown
layout: 'post'
title: 'Lustre故障跟踪之Bad checksums from clients using SR-IOV'
tags: Lustre

在OpenStack的vm上使用Lustre Client有bug

Server使用物理机或者VM
客户端使用VM, IB卡使用SR-IOV
在读取数据时Client会发生下面的错误:
```bash
Aug  1 20:06:12 host-1 kernel: LustreError: 133-1: testfs-OST0001-osc-ffff92d61a60e800: BAD READ CHECKSUM: from xx.xx.xx.xx@o2ib inode [0x2000004c6:0x5052:0x0] object 0x0:5109886 extent [0-1048575], client 2cee4ae9, server 37b5479a, cksum_type 2
```
>  RPC大小设置的1MB

Server会出现下面的错误:
```bash
Aug  1 20:08:16 host-xx kernel: LustreError: 132-0: cachefs-OST0007: BAD READ CHECKSUM: should have changed on the client or in transit: from xx.xx.xx.xx@o2ib inode [0x200000c5d:0x19ffa:0x0] object 0x0:1481244 extent [0-140088], client returned csum 613a205d (type 20), server csum 2e8e1f40 (type 20)
```

社区有jia r
